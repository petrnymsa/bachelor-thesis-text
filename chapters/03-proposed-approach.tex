% \todo{
% \begin{itemize}
% \item introduction
% \item ``the blind way?'' - first attempts, visualisation directly with OCD
%   \begin{itemize}
%   \item Why it was bad idea
%   \end{itemize}
% \item Better approach - gantt chart
%   \begin{itemize}
%   \item Proposed first concept
%   \item Time calculation via PERT (beta distribution)
%   \item Gantt chart elements (progress bars, tree transaction view, transaction links,...)
%   \end{itemize}
% \end{itemize}}

The main goal of the thesis is to propose an approach which will be able to create the graphical overviews of critical business data and make decisions based on them. This chapter describes each part of the proposed approach. The chapter is divided to these parts:	
    \begin{enumerate}
      \item Which kind of data the application collects and how works with them.
      \item How real-time process visualization is done.
      \item What kind of overviews the application can display. 
    \end{enumerate}
    
\section{Business Data Aggregation}
Each enterprise system collects precious data within business. These data are important in many ways. One is for business analysts. Analyst can with these collected data analyse processes and optimize them. Although every enterprise solution has differently defined structure of these data and every \gls{bpms} has different approach how it works with them, the core concept of how data can be described remains the same. 
Within \gls{bpms} there are elements which can be transformed always to the \gls{demo} concepts.
\begin{itemize}
\item There are always some kind of \textit{Actor roles} and concrete \textit{Actors}. Commonly \gls{bpms} defines \textit{Actor roles} as ``roles'' and \textit{Actors} defines as ``users''.
\item The processes itself can be transformed to \textit{Transactions}. In~\cref{ch:theoretical-foundations} was explained that each process can be described on ontological level and has precise definition what kind of process it is and the responsibilities of \textit{Actors}.
\item Each \gls{bpms} provides some kind of events, which can be used to determine what exactly happened and how it is connected to the model defined within \gls{demo}.
\end{itemize}

\begin{figure}[ht!]
  \centering
  \includegraphics[width=12cm,keepaspectratio]{img/bi-demo-overview}
  \caption{Business Intelligence based on DEMO}
  \label{fig:bi-demo-overview}
\end{figure}    

In this way the system of visualisation based on \gls{demo} can be nearly independent from other systems within enterprise. The architecture of Business Intelligence based on \gls{demo} is shown at~\cref{fig:bi-demo-overview}. The enterprise does not need necessary a \gls{bpms}. Within enterprise, many systems and applications exists. Even without BPMS solutions within enterprise there are still the same kind of processes and actor roles which can be modelled through \gls{demo}.

Inside an enterprise there can be many systems and (not necessary) in front of them can be a \gls{bpms} solution. On the ``borders'' of the \textit{Enterprise} is placed \textit{Data Aggregation Service}. This service has responsibility of getting data from an \textit{Enterprise} and transforming them to the structure that \textit{Business Intelligence Services} can it use. Collected data from \textit{Data Aggregation Service} are mapped to defined \textit{DEMO Model}.
With this approach, \textit{Business Intelligence Services} can take advantages of \gls{demo} without requirement to be dependent directly on enterprise systems.

\subsection{Business Data Domain Model}
\begin{figure}[ht!]
  \centering
  \includegraphics[width=13cm,keepaspectratio]{img/domain-data-model}
  \caption{Domain model of collected data}
  \label{fig:domain-data-model}
\end{figure}    

The one of the most important thing what needs to be defined is how collected data can be expressed for visualisation. The \cref{fig:domain-data-model} shows domain-data model which describes how \gls{demo} model can be described.  

\Cref{fig:domain-data-model} is divided to three parts:
\begin{description}
\item[Model] Defines how \gls{demo} model can be described. It corresponds with \gls{ocd} and \gls{psd} models.
\item[Instance] The one concrete running process. It indicates state of transactions. 
\item[Event] Last part defines the concrete occurred events from internal systems which can be collected and transformed to data, that can be used. 
\end{description}

The brief explanation of each entity from domain model:
\begin{description}
\item[Actor Role] Defines role within enterprise. 
\item[Actor] Defines concrete user within enterprise, which has assigned \textit{Actor Role}.

\item[Process Kind] Defines exactly one concrete business process inside enterprise. Each \textit{Process Kind} has linked amount of \textit{Transaction Kinds}.

\item[Process Instance] The instance of concrete \textit{Process Kind}. Defines process \textit{Completion}, date when process instance was created (\textit{StartTime}) and expected time when whole process will be completed (\textit{ExpectedEndTime}).

\item[Transaction Kind] Defines the transaction kind. It has linked information, which \textit{Actor Role} is initiator or executor respectively. Also defines the time estimates for transaction completion. These three time estimates -- \textit{Optimistic}, \textit{Normal}, \textit{Pessimistic} are used to compute real expected time. 

\item[Transaction Link] Defines the \textit{response} or \textit{waiting} links. Each link has defined \textit{target Transaction Kind}  and \textit{source Transaction Kind} to determine which two \textit{Transaction Kinds} link connects. Link also defines \textit{Source Cardinality} and \textit{Target Cardinality} to define cardinalities. Moreover link defines which \textit{C-Act} is assigned to source and target transactions.  

\item[Transaction Instance] Each \textit{Transaction Kind} could have more than one instance. Transaction Instance includes information about \textit{Completion} and \textit{Requested Time}. The instance itself could have more than one children. 

\item[Event] An entity to define events which can occur during the running process. Each event has time creation (\textit{Created}) and duration how long it take to between last event and before event was created.

% \item[Completion Changed Event] Event which describes that some C-Act happened within transaction. 
% \item[Initiator / Executor Event] Events which describe that initiator or executor were assigned to \textit{Transaction Instance}. In other words, \textit{Transaction Instance} was initiated or executed by given initiator or executor respectively.
\end{description}

% These entities serves mainly for defining model within enterprise with \gls{demo} methodology and collecting events from internal enterprise applications.

\section{Case Study Rent-A-Car}
Although all proposed approaches are defined generally, the case study is used to demonstrate usage and show examples. The case study is taken from book by J.Dietz~\cite{dietz-essence-2015}. A Rent-A-Car is company which offers cars for rent. Simplified description:

\gls{rac} is a company that rents a cars to persons or a representatives of legal bodies (e.g. companies). \gls{rac} operates from over fifty branches in Europe. Many cities have more than one branch and typically branches are located near all airports. 
Customer orders are placed through several channels: walk-in, telephone, fax or email. Walk-in customers are usually people who want to rent a car immediately. In all cases, an electronic rental form is filled out by one of the desk officers. 
After the renter has signed the contract, the rental is concluded by the desk officer. On the starting day, the driver can pick up a card at the distribution department. When driver shows up, \gls{rac} employee checks whether there is a car available. If there is one, he prepare car and sign contract as being picked up. If there is no car, he will upgrade the contract and select a different car. 
After the car of rental has been dropped off, there is chance to pay some fines. There many types of penalties.

The \gls{ocd} and \gls{psd} of \gls{rac} are shown at~\cref{fig:rac-ocd} and \cref{fig:rac-psd} respectively.
\begin{figure}[ht!]
\centering
\includegraphics[width=10cm,keepaspectratio]{img/rac-ocd}
\caption{RAC OCD}
\label{fig:rac-ocd}
\end{figure}

\begin{figure}[ht!]
 \centering
 \subfloat{{\includegraphics[width=6cm, keepaspectratio]{img/rac-psd-one} }}%
 \qquad
 \subfloat{{\includegraphics[width=6cm, keepaspectratio]{img/rac-psd-two} }}%
 \caption{RAC PSD}%
 \label{fig:rac-psd}%
\end{figure}
\newpage

\section{Data Labelling}
As has been said, every system within enterprise provides some collection of data. Problem is, if enterprise does note use centralized solution (a some form of \gls{bpms}), format of collected data can be very different. 
However collected data can be structured and then processed via procedure, named ``labelling''. Every system can provide collected data with some structured form. Then sooner defined \textit{Data Aggregation Service} must have mechanism how this structure map to defined \gls{demo} model. This mechanism will be for every enterprise and theirs systems unique, however fundamental idea and work-flow is the same.

Firstly used terms are defined:
\begin{description}
\item[log] The structured collected data from enterprise systems
\item[case id] The defined process.
\item[creation timestamp] Timestamp when created.
\item[end timestamp] Indicated end of given task.
\item[activity] An activity (task) within case.
\item[resource] An resource associated with activity. Typically an user.
\item[role] A user role which invoked an activity.
\end{description}

\Cref{tab:rac-log} is an shortened log from \textit{Rent-A-Car} company. The ``case id'' is equal to 1 (which is generally some internal identifier) and it is omitted from table. Also timestamps are omitted because they are not, for now, important.  

There are several activities, resources and roles. ``Labelling'' mechanism must distinguish each one of activities and assign appropriate \textit{Transaction} and \textit{Coordination-act} from \gls{demo} model. Also ``roles'' must be assigned to \textit{Actor roles} and ``resource'' is assigned as \textit{Actor}. An shortened example of ``labelling'' is shown at~\cref{tab:rac-log-labelling}. The ``role'' and \textit{Actor roles} are absolutely the same. 

\begin{table}[ht!]
\centering
\begin{tabular}{ | c | c | c | }
\hline
	\textbf{Activity} & \textbf{Resource} & \textbf{Role} \\ \hline
	Create Rental  Requisition & Peter Freeman & Renter \\ \hline
	Create Request for Payment & Alice Gree & Rental Contracter \\ \hline
	Payment Promise & Peter Freeman & Renter \\ \hline
	Analyse Rental Requisition & Alice Gree & Rental Contracter \\ \hline
	Make a Payment & Peter Freeman & Renter \\ \hline
	Accept Payment & Alice Gree & Rental Contracter \\ \hline
	Create a New Contract & Alice Gree & Rental Contracter \\ \hline
	Hand Over Contract to Customer & Alice Gree & Rental Contracter \\ \hline
	Customer Accepted Contract & Peter Freeman & Renter \\ \hline
	Create Car Pick Up  Requisition & Peter Freeman & Driver \\ \hline
    \multicolumn{3}{|c|}{\dots} \\ \hline
    
% 	Acquire Car Pick Up Request & Bob Hershel & Car Issuer \\ \hline
% 	Create Car Drop Off Requisition & Bob Hershel & Car Issuer \\ \hline
% 	Drop Off Requisition Agreement & Peter Freeman & Driver \\ \hline
% 	Car Preparation & Bob Hershel & Car Issuer \\ \hline
% 	Car Prepared for Pick Up & Bob Hershel & Car Issuer \\ \hline
% 	Driver Acquired the Car & Peter Freeman & Driver \\ \hline
% 	Customer Returning the Car & Peter Freeman & Driver \\ \hline
% 	Customer Returned the Car & Peter Freeman & Driver \\ \hline
% 	Car Returned & Bob Hershel & Car Issuer \\ \hline  
\end{tabular}
\caption{An example log of Rent-A-Car company}
\label{tab:rac-log}
  
\begin{tabular}{ | c | c | c | }
\hline
	\textbf{Activity} & \textbf{Transaction} & \textbf{State} \\ \hline
	Create Rental  Requisition & T1 & Request \\ \hline
	Create Request for Payment & T2 & Request \\ \hline
	Payment Promise & T2 & Promise \\ \hline
	Analyse Rental Requisition & T1 & Promise \\ \hline
	Make a Payment & T2 & State \\ \hline
	Accept Payment & T2 & Accept \\ \hline
	Create a New Contract & T1 & Execute \\ \hline
	Hand Over Contract to Customer & T1 & State \\ \hline
	Customer Accepted Contract & T1 & Accept \\ \hline
	Create Car Pick Up  Requisition & T3 & Request \\ \hline
    \multicolumn{3}{|c|}{\dots} \\ \hline
% 	Acquire Car Pick Up Request & T3 & Promise \\ \hline
% 	Create Car Drop Off Requisition & T4 & Request \\ \hline
% 	Drop Off Requisition Agreement & T4 & Promise \\ \hline
% 	Car Preparation & T3 & Execute \\ \hline
% 	Car Prepared for Pick Up & T3 & State \\ \hline
% 	Driver Acquired the Car & T4 & Accept \\ \hline
% 	Customer Returning the Car & T4 & Execute \\ \hline
% 	Customer Returned the Car & T4 & State \\ \hline
% 	Car Returned & T4 & Accept \\ \hline
\end{tabular}
\caption{Activities labelling from RAC log}
\label{tab:rac-log-labelling}
\end{table}
\clearpage

\section{Process Instance Visualisation}
System must have ability to visualise running process instances in real-time. User can open running process and can be informed how it continues. 

The biggest challenge was how to propose a way to visualise models modelled with \gls{demo}. Moreover, the intent was mainly to provide visualisation on mobile devices (smart-phones, tablets).

There are four conditions how visualisation must be proposed:
\begin{enumerate}
	\item The proposed way must preserve the intention of modelled model through \gls{demo}.
    \item Visualisation must be consistent accordingly to defined \gls{demo} model.
    \item The proposed way must be easy to use and understand.  
    \item It must be adaptive to different sizes of mobile devices. 
\end{enumerate}

The first idea of visualisation was highly inspired from investigated existing solutions (\textit{Process Maker}, \textit{Bizagi Modeler}). Visualisation could be done with \gls{demo} \gls{ocd} model itself. With this approach user could have:
\begin{enumerate}
  \item The exactly same understanding of modelled enterprise.
  \item The straightforward visualisation of instances through defined models. If user understand \gls{demo} models, this approach of visualisation has the same meaning.
\end{enumerate}

With this approach first two conditions are accomplished:
\begin{enumerate}
\item Defined enterprise is directly exposed with \gls{ocd} model. However some information are hidden. As is known, the \gls{psd} brings more information how processes are defined and how they work. (i).
\item Consistency is tied with \gls{ocd} itself (ii).
\end{enumerate}

However the (iii) and (iv) are not so straightforward. The third condition (iii) is not accomplished because DEMO is used and it does not have to be easy to use and understand. In every enterprise there are specialists (business analysts) that have the responsibility to analyse given enterprise and specify models (for example within \gls{demo}). Other people do not need to have knowledge about this methodology, overall they do not need to have knowledge about some models either. Although \gls{ocd} itself is very concise, it is not so suitable to smaller screens of mobile devices. This implies, that also (iv) is violated.

\section{A Better Option}
Gantt chart is widely used in time-management projects and systems. It is well known, established and used. From the business point of view, Gantt chart offer the best approach, how tasks can be visualised. 
It is uses a time-line, which user naturally understands and it is nicely connected

\subsection{\todo{PERT - beta distribution}}
\subsection{\todo{Elements}}

\section{\todo{Graphs as Widgets, Dashboard}}
\section{\todo{Queries and editor}}
\section{\todo{A Few More Ideas of Visualisation}}

\todo{heat map, as-is, what-if,...}


%     \section{Overviews}
    
%     \section{Process visualization}
    
%     \section{Mobile application concept}
	
% 	\todo{Domain model of collected data. Proposed way of real time visualization. Type of charts. Dashboard. Whole concept of application, e.g dashboard, editor. Functional specification, a.k.a example use cases?? Domain model of collected data.}
    
%     \section{Analysis}    

   

% 	\section{The dashboard}
%     Purpose of dashboard is provide centralized overview of processes such as average waiting time before process is completed or total amount of requests per day. The appearance of dashboard depends on user. \gls{dwma} provides customizable elements called widgets to achieve desired look for every user individually.

%     \subsection{Widgets}  
%      Widgets are small independent configurable components for displaying collected data from business processes. Each one has purpose. Notice that widgets are only user-friendly view of query above collected data. For editing widgets there is widget editor. User can simply edit properties of widget such as name, category, tags and of course source of data - the query and second important property is the type of widget. There are following types of widgets:
     
%      \textbf{The summary widget} (\cref{fig:widget-summary}) provides, by it's name, chart with summarization of collected data. Concrete type of the chart depends on the user and on the data. Summary widget provides several types of charts:
     
%      \begin{enumerate}
%     	\item \textit{Pie} chart is used to illustrate numerical proportion.         
%         \item  \textit{Bar} chart displays categorical data with numerical value.
%         %\item \textit{Line}
%     \end{enumerate}
      
%       \begin{figure}[ht!]
%           \centering
%           \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%           \caption{Summary widget example}
%           \label{fig:widget-summary}
%       \end{figure}   
    
%    	Second type is \textbf{Time period} (\cref{fig:widget-time-period}). Time period displays data in some interval. Typically it can serve as overview \textit{``Number of requests for Rental payment per day"}.        
      
%       \begin{figure}[ht!]
%           \centering
%           \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%           \caption{Time period widget example}
%           \label{fig:widget-time-period}
%       \end{figure}
    
%     Last type is \textbf{Single query} (\cref{fig:widget-single-query}) which allows display simple result from query. Prerequisite for query is that query returns one single record. 
      
%       \begin{figure}[ht!]
%           \centering
%           \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%           \caption{Single query example}
%            \label{fig:widget-single-query}
%       \end{figure}       
    
%     \subsection{Query editor}
    
%     \todo{Information about query editor}
    
%     \begin{figure}[ht!]
%           \centering
%           \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%           \caption{\todo{Query editor}}
%       \end{figure}   
    
%     \section{The real-time overview of process instance}
%     \todo{Introduction about gantt chart. Make conversation about classic OCD / PSD diagrams and their pros and cons for visualizations}
%     Provides the real-time overview of one concrete process instance.
% On the left side is tree-view (like in folder explorer) of transactions. Each transaction has identifier and name.
% On the top is the timeline which displays important events from the process. Above timeline is visualization itself. Each transaction is displayed as progress bar with some visual tweak, which will be discussed later.

% 	Each transaction can be at one of the following state, which has different visual: 
% 	\todo{Categories}
    
%     \begin{description}
%     	\item[Not active transaction] Is displayed as greyed out progress bar. It means that this instance of transaction will be probably started at some future time.

%         \item[Active transaction] Progress bar is displayed with green colour to show current progress of instance transaction. 
        
%         \item[Completed transaction] Progress bar is fulfilled with green colour. It means that given transaction successfully ended (was accepted).
        
%         \item[Stopped transaction] Progress bar changed colour to red which indicates that transaction failed to complete due to fact that it was quitted or stopped. 
%     \end{description}
    
%  \subsection{Response and waiting links}
%     \todo{Change this}
%    Each transaction can have several child-transactions and also many conditional links. These conditions are displayed with arrows pointed to another transaction with the condition.
% Conditions are divided into two categories.

% If the condition is ``Some state of transaction A has to be done before transaction B can start (be requested)", e.g. transaction A must be stated before transaction B can be requested (\cref{fig:request-start-condition}).

% \begin{figure}
%   \centering
%   \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%   \caption{\todo{Request-start condition}}
%   \label{fig:request-start-condition}
% \end{figure}  

% If condition is ``Some state of transaction A has to be done before transaction B can be at another state", e.g transaction A must be at least stated before transaction B can be promised (\cref{fig:state-state-condition}).

% \begin{figure}
%   \centering
%   \includegraphics[width=6cm,keepaspectratio]{img/TODO-image}
%   \caption{\todo{State-state condition}}
%   \label{fig:state-state-condition}
% \end{figure}  

